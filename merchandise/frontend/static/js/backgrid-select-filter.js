(function(){var a=Backgrid.Extension.SelectFilter=Backbone.View.extend({tagName:"select",className:"backgrid-filter",template:_.template(["<% for (var i=0; i < options.length; i++) { %>","  <option value='<%=JSON.stringify(options[i].value)%>' <%=options[i].value === initialValue ? 'selected=\"selected\"' : ''%>><%=options[i].label%></option>","<% } %>"].join("\n")),events:{change:"onChange"},defaults:{selectOptions:void 0,field:void 0,clearValue:null,initialValue:void 0,makeMatcher:function(a){return function(b){return b.get(this.field)==a}}},initialize:function(b){if(a.__super__.initialize.apply(this,arguments),_.defaults(this,b||{},this.defaults),_.isEmpty(this.selectOptions)||!_.isArray(this.selectOptions))throw"Invalid or missing selectOptions.";if(_.isEmpty(this.field)||!this.field.length)throw"Invalid or missing field.";void 0===this.initialValue&&(this.initialValue=this.clearValue);var c=this.collection=this.collection.fullCollection||this.collection,d=this.shadowCollection=c.clone();this.listenTo(c,"add",function(a,b,c){d.add(a,c)}),this.listenTo(c,"remove",function(a,b,c){d.remove(a,c)}),this.listenTo(c,"sort",function(a){this.currentValue()==this.clearValue&&d.reset(a.models)}),this.listenTo(c,"reset",function(a,b){b=_.extend({reindex:!0},b||{}),b.reindex&&null==b.from&&null==b.to&&d.reset(a.models)})},render:function(){return this.$el.empty().append(this.template({options:this.selectOptions,initialValue:this.initialValue})),this.onChange(),this},currentValue:function(){return JSON.parse(this.$el.val())},onChange:function(a){var b=this.collection,d=(this.field,this.currentValue()),e=_.bind(this.makeMatcher(d),this);b.pageableCollection&&b.pageableCollection.getFirstPage({silent:!0}),d!==this.clearValue?b.reset(this.shadowCollection.filter(e),{reindex:!1}):b.reset(this.shadowCollection.models,{reindex:!1})}})}).call(this);